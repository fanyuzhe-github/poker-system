(function(t){function e(e){for(var s,o,i=e[0],l=e[1],c=e[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],s=!0,i=1;i<a.length;i++){var l=a[i];0!==r[l]&&(s=!1)}s&&(n.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},r={app:0},n=[];function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0b46":function(t,e,a){},"0ffd":function(t,e,a){t.exports=a.p+"img/dierming1.36686757.svg"},"2fb8":function(t,e,a){"use strict";a("f6fe")},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("GameDetail")],1)},n=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail"},[e("div",{staticClass:"operation-button"},[e("el-button",{attrs:{type:t.isPlaying?"primary":"success",plain:"",disabled:t.isPlaying,icon:t.isPlaying?"el-icon-basketball":"el-icon-guide"},on:{click:function(e){return t.resetSeat()}}},[t._v(t._s(t.isPlaying?"游戏中...":"开局选座"))]),e("div",{staticStyle:{width:"60%"}},[e("el-select",{staticClass:"select-players",attrs:{placeholder:"请选择或添加玩家",multiple:"","popper-class":"selectCls",filterable:"",disabled:t.isPlaying},model:{value:t.selectPlayers,callback:function(e){t.selectPlayers=e},expression:"selectPlayers"}},t._l(t.accounts,(function(a){return e("el-option-group",{key:a.name,attrs:{label:a.name}},t._l(a.subAccounts,(function(a){return e("el-option",{key:a.value,attrs:{label:a.name,value:a.value,disabled:t.disabledFun(a.value)}})})),1)})),1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:t.isPlaying},on:{click:function(e){t.outerVisible=!0}}},[t._v("添加玩家")])],1),e("el-button",{attrs:{type:"info",plain:"",icon:"el-icon-s-data"},on:{click:function(e){t.scoreboardDrawer=!0}}},[t._v("查看总排行榜")])],1),0!==t.players.length?e("div",{staticClass:"content"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.playersSort,stripe:""}},[e("el-table-column",{attrs:{prop:"seatNum",label:"座位号",width:"80"}}),e("el-table-column",{attrs:{prop:"name",label:"玩家",width:"200","class-name":"player-cell"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"avatar-box",staticStyle:{height:"30px"}},[a.row.avatar?e("el-avatar",{attrs:{size:30,src:a.row.avatar}}):e("el-avatar",{staticClass:"avatar-empty",attrs:{size:30}},[t._v(t._s(a.row.name))])],1),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(a.row.name))])]}}],null,!1,3562186737)}),e("el-table-column",{attrs:{prop:"chips",label:"剩余筹码"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticClass:"chips",attrs:{placeholder:"请输入该玩家手中剩余筹码",size:"mini",clearable:""},on:{input:function(e){return t.limitInput(a.row)}},model:{value:a.row.chips,callback:function(e){t.$set(a.row,"chips",e)},expression:"scope.row.chips"}})]}}],null,!1,4073931798)})],1),0!==this.playersSort.length?e("div",{staticClass:"account-button"},[e("el-button",{attrs:{type:"primary",round:""},on:{click:t.settleAccount}},[t._v("结算本局")]),e("el-switch",{staticClass:"humane-model",attrs:{"active-text":"人道模式结算"},model:{value:t.humaneModel,callback:function(e){t.humaneModel=e},expression:"humaneModel"}})],1):t._e()],1),e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",staticStyle:{"text-align":"center",color:"blueviolet","font-weight":"bold"},attrs:{slot:"header"},slot:"header"},[e("span",[t._v("今日排行榜")])]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.players}},[e("el-table-column",{attrs:{label:"排名",width:"50"},scopedSlots:t._u([{key:"default",fn:function(s){return[0===s.$index?e("img",{staticClass:"medal",attrs:{src:a("ba15")}}):1===s.$index?e("img",{staticClass:"medal",attrs:{src:a("d4f6")}}):2===s.$index?e("img",{staticClass:"medal",attrs:{src:a("a3b9")}}):e("span",{staticStyle:{"font-size":"13px","margin-left":"5px"}},[t._v(t._s(s.$index+1))])]}}],null,!1,2388237422)}),e("el-table-column",{attrs:{prop:"name",label:"玩家",width:"180","class-name":"player-cell"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"avatar-box"},[0===s.$index?e("img",{staticClass:"diyiming-avatar",attrs:{src:a("8ba7")}}):1===s.$index?e("img",{staticClass:"dierming-avatar",attrs:{src:a("0ffd")}}):2===s.$index?e("img",{staticClass:"dierming-avatar",attrs:{src:a("e4c1")}}):t._e(),s.row.avatar?e("el-avatar",{attrs:{size:30,src:s.row.avatar}}):e("el-avatar",{staticClass:"avatar-empty",attrs:{size:30}},[t._v(t._s(s.row.name))])],1),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(s.row.name))])]}}],null,!1,4103118005)}),e("el-table-column",{attrs:{label:"胜/负",formatter:t.formatterResult}}),e("el-table-column",{attrs:{label:"胜率"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:t.addRateClass(a.row,t.players)},[t._v(t._s(t.formatterWinRate(a.row)))])]}}],null,!1,90410123)}),e("el-table-column",{attrs:{label:"状态",formatter:t.formatterState},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:t.addStateClass(a.row,t.players)},[t._v(t._s(t.formatterState(a.row)))])]}}],null,!1,1367969307)}),e("el-table-column",{attrs:{prop:"score",label:"积分"}})],1)],1)],1)],1)],1):t._e(),e("el-drawer",{attrs:{title:"结算明细",visible:t.drawer,direction:"rtl","before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[0!==t.resultInfo.length?[e("el-result",{attrs:{icon:"success"}}),t._l(t.resultInfo,(function(a,s){return e("div",{key:s,staticStyle:{"margin-bottom":"10px"}},[e("span",{staticStyle:{"margin-left":"20px"}},[t._v(t._s(a))]),e("el-divider")],1)}))]:e("el-result",{attrs:{icon:"info",title:"无需转账操作"}}),e("div",{staticClass:"drawer__footer"},[e("el-button",{on:{click:t.cancelInfo}},[t._v("关 闭")]),e("el-button",{attrs:{type:"danger"},on:{click:t.gameAgain}},[t._v("再来一局")])],1)],2),e("el-drawer",{attrs:{visible:t.scoreboardDrawer,"with-header":!1,size:"50%"},on:{"update:visible":function(e){t.scoreboardDrawer=e}}},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",staticStyle:{"text-align":"center",color:"blueviolet","font-weight":"bold"},attrs:{slot:"header"},slot:"header"},[e("span",[t._v("总排行榜")])]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.allPlayers}},[e("el-table-column",{attrs:{label:"排名",width:"50"},scopedSlots:t._u([{key:"default",fn:function(s){return[0===s.$index?e("img",{staticClass:"medal",attrs:{src:a("ba15")}}):1===s.$index?e("img",{staticClass:"medal",attrs:{src:a("d4f6")}}):2===s.$index?e("img",{staticClass:"medal",attrs:{src:a("a3b9")}}):e("span",{staticStyle:{"font-size":"13px","margin-left":"5px"}},[t._v(t._s(s.$index+1))])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"玩家",width:"180","class-name":"player-cell"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"avatar-box"},[0===s.$index?e("img",{staticClass:"diyiming-avatar",attrs:{src:a("8ba7")}}):1===s.$index?e("img",{staticClass:"dierming-avatar",attrs:{src:a("0ffd")}}):2===s.$index?e("img",{staticClass:"dierming-avatar",attrs:{src:a("e4c1")}}):t._e(),s.row.avatar?e("el-avatar",{attrs:{size:30,src:s.row.avatar}}):e("el-avatar",{staticClass:"avatar-empty",attrs:{size:30}},[t._v(t._s(s.row.name))])],1),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(s.row.name))])]}}])}),e("el-table-column",{attrs:{prop:"score",label:"胜/负",formatter:t.formatterResult}}),e("el-table-column",{attrs:{label:"胜率"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:t.addRateClass(a.row,t.allPlayers)},[t._v(t._s(t.formatterWinRate(a.row)))])]}}])}),e("el-table-column",{attrs:{label:"状态",formatter:t.formatterState},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:t.addStateClass(a.row,t.allPlayers)},[t._v(t._s(t.formatterState(a.row)))])]}}])}),e("el-table-column",{attrs:{prop:"score",label:"积分"}})],1)],1)],1),e("el-dialog",{attrs:{title:"添加账号",visible:t.outerVisible},on:{"update:visible":function(e){t.outerVisible=e},closed:t.handleAddAccountClosed}},[e("el-form",{ref:"accountForm",attrs:{model:t.accountForm,"label-width":"80px",rules:t.rules}},[e("div",{staticClass:"add-avatar"},[e("div",{staticClass:"avatar-wrap"},[t.currentAccountAvatar?e("el-avatar",{attrs:{size:100,src:t.currentAccountAvatar}}):e("el-avatar",{attrs:{size:100}},[t._v(t._s(t.accountForm.mainAccount))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.uploadPicture(t.currentAccountAvatar)}}},[t._v("更改头像")])],1)]),e("el-form-item",{staticClass:"main-account",attrs:{label:"主账号",prop:"mainAccount"}},[e("el-select",{attrs:{placeholder:"请选择主账号"},model:{value:t.accountForm.mainAccount,callback:function(e){t.$set(t.accountForm,"mainAccount",e)},expression:"accountForm.mainAccount"}},t._l(t.mainAccounts,(function(t){return e("el-option",{key:t.label,attrs:{label:t.label,value:t.label}})})),1),e("el-button",{attrs:{icon:"el-icon-user-solid"},on:{click:t.openAddAccount}},[t._v("添加")])],1),e("el-form-item",{staticClass:"sub-account",attrs:{label:"小号名称",prop:"subAccount"}},[e("el-input",{model:{value:t.accountForm.subAccount,callback:function(e){t.$set(t.accountForm,"subAccount",e)},expression:"accountForm.subAccount"}})],1)],1),e("el-dialog",{attrs:{width:"30%",title:"主账号名称",visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e}}},[e("el-input",{attrs:{placeholder:"请输入主账号名称",clearable:""},model:{value:t.accountInput,callback:function(e){t.accountInput=e},expression:"accountInput"}}),e("div",{staticClass:"add-account-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.addMainAccount}},[t._v("添 加")])],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.outerVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addAccount}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"裁剪图片",visible:t.cropperModel,width:"950px",center:""},on:{"update:visible":function(e){t.cropperModel=e}}},[t.cropperModel?e("CropperImage",{ref:"child",attrs:{Name:t.cropperName},on:{uploadImgSuccess:t.handleUploadSuccess}}):t._e()],1)],1)},i=[];a("14d9"),a("13d5");class l{constructor(t,e,a,s,r,n,o,i){this.seatNum=t,this.name=e,this.chips=a,this.raceResult=s,this.raceDate=r,this.score=n,this.avatar=o,this.pid=i,this.lastState="deuce",this.stateTimes=0}}var c=a("5c8a"),u=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cropper-content"},[e("div",{staticClass:"cropper-box"},[e("div",{staticClass:"cropper"},[e("vue-cropper",{ref:"cropper",attrs:{img:t.option.img,outputSize:t.option.outputSize,outputType:t.option.outputType,info:t.option.info,canScale:t.option.canScale,autoCrop:t.option.autoCrop,autoCropWidth:t.option.autoCropWidth,autoCropHeight:t.option.autoCropHeight,fixed:t.option.fixed,fixedNumber:t.option.fixedNumber,full:t.option.full,fixedBox:t.option.fixedBox,canMove:t.option.canMove,canMoveBox:t.option.canMoveBox,original:t.option.original,centerBox:t.option.centerBox,height:t.option.height,infoTrue:t.option.infoTrue,maxImgSize:t.option.maxImgSize,enlarge:t.option.enlarge,mode:t.option.mode},on:{realTime:t.realTime,imgLoad:t.imgLoad}})],1),e("div",{staticClass:"footer-btn"},[e("div",{staticClass:"scope-btn"},[e("input",{staticStyle:{position:"absolute",clip:"rect(0 0 0 0)"},attrs:{type:"file",id:"uploads",accept:"image/png, image/jpeg, image/gif, image/jpg"},on:{change:function(e){return t.selectImg(e)}}}),e("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-zoom-in"},on:{click:function(e){return t.changeScale(1)}}},[t._v("放大")]),e("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-zoom-out"},on:{click:function(e){return t.changeScale(-1)}}},[t._v("缩小")]),e("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:t.rotateLeft}},[t._v("↺ 左旋转")]),e("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:t.rotateRight}},[t._v("↻ 右旋转")])],1)])]),e("div",{staticClass:"show-preview"},[e("div",{staticClass:"preview"},[e("img",{style:t.previews.img,attrs:{src:t.previews.url}})]),e("div",{staticClass:"upload-btn"},[e("label",{staticClass:"btn",attrs:{for:"uploads"}},[t._v("选择图片")]),e("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.uploadImg()}}},[t._v("确认上传 "),e("i",{staticClass:"el-icon-upload"})])],1)])])},p=[],d=(a("88a7"),a("271a"),a("5494"),a("b7ef"),a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1"),a("7e79")),m={name:"CropperImage",components:{VueCropper:d["VueCropper"]},props:["Name"],data(){return{name:this.Name,resImg:"",previews:{},option:{img:this.Name,outputSize:1,outputType:"png",info:!0,canScale:!0,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixed:!1,fixedNumber:[1,1],full:!1,fixedBox:!0,canMove:!0,canMoveBox:!0,original:!1,centerBox:!0,height:!1,infoTrue:!1,maxImgSize:3e3,enlarge:1,mode:"auto 600px"}}},methods:{imgLoad(t){console.log("工具初始化函数====="+t)},changeScale(t){t=t||1,this.$refs.cropper.changeScale(t)},rotateLeft(){this.$refs.cropper.rotateLeft()},rotateRight(){this.$refs.cropper.rotateRight()},realTime(t){let e=this;e.previews=t,this.$refs.cropper.getCropBlob(t=>{this.blobToDataURI(t,(function(t){e.previewImg=t}))})},blobToDataURI(t,e){var a=new FileReader;a.readAsDataURL(t),a.onload=function(t){e(t.target.result)}},selectImg(t){console.log(this.option.img);let e=t.target.files[0];if(!/\.(jpg|jpeg|png|JPG|PNG)$/.test(t.target.value))return this.$message({message:"图片类型要求：jpeg、jpg、png",type:"error"}),!1;let a=new FileReader;a.onload=t=>{let e;e="object"===typeof t.target.result?window.URL.createObjectURL(new Blob([t.target.result])):t.target.result,this.option.img=e},console.log(this.option.img),a.readAsDataURL(e)},base64ImgtoFile(t,e="file"){const a=t.split(","),s=a[0].match(/:(.*?);/)[1],r=s.split("/")[1],n=atob(a[1]);let o=n.length;const i=new Uint8Array(o);while(o--)i[o]=n.charCodeAt(o);return new File([i],`${e}.${r}`,{type:s})},uploadFile(t){this.$emit("uploadImgSuccess",t)},uploadImg(){this.$refs.cropper.getCropData(t=>{this.uploadFile(t)})}}},h=m,f=(a("b8b4"),a("2877")),b=Object(f["a"])(h,u,p,!1,null,"64e7c89e",null),g=b.exports,v={components:{CropperImage:g},data(){return{rules:{mainAccount:[{required:!0,message:"请选择一个主账号",trigger:"change"}],subAccount:[{required:!0,message:"请输入小号名称",trigger:"blur"}]},currentAccountAvatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",cropperModel:!1,cropperName:"",accountInput:"",accountForm:{mainAccount:"",subAccount:""},outerVisible:!1,innerVisible:!1,accounts:JSON.parse(localStorage.getItem("accounts")),selectPlayers:[],playerOptions:[],players:[],playersSort:[],drawer:!1,baseChips:10,resultInfo:[],humaneModel:!1,isPlaying:!1,scoreboardDrawer:!1,allPlayers:JSON.parse(localStorage.getItem("allPlayers"))}},computed:{mainAccounts(){return this.accounts.map(t=>({label:t.name,avatar:t.avatar}))},selectPlayersMap(){const t=[];return this.accounts.forEach(e=>{e.subAccounts.forEach(a=>{t.push({name:a.name,pid:e.name,avatar:e.avatar})})}),t}},watch:{"accountForm.mainAccount":{handler(t){if(t){const e=this.mainAccounts.find(e=>e.label===t);this.currentAccountAvatar=e.avatar}else this.currentAccountAvatar="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"},deep:!0}},created(){this.accounts?this.accounts=JSON.parse(localStorage.getItem("accounts")):(this.accounts=[{name:"范宇哲",avatar:"",subAccounts:[{name:"沙河彭于晏",value:"范宇哲-沙河彭于晏"}]},{name:"丁克实",avatar:"",subAccounts:[{name:"黑猫警长",value:"丁克实-黑猫警长"}]},{name:"陈一正",avatar:"",subAccounts:[{name:"沙河海森堡",value:"陈一正-沙河海森堡"}]},{name:"张经伦",avatar:"",subAccounts:[{name:"沙河周杰伦",value:"张经伦-沙河周杰伦"}]},{name:"李骜",avatar:"",subAccounts:[{name:"特异功能",value:"李骜-特异功能"}]},{name:"雷宇",avatar:"",subAccounts:[{name:"崔各庄伽利略",value:"雷宇-崔各庄伽利略"}]},{name:"洋洋",avatar:"",subAccounts:[{name:"沙河迪丽热巴",value:"洋洋-沙河迪丽热巴"}]}],localStorage.setItem("accounts",JSON.stringify(this.accounts)))},methods:{createPlayer(t,e,a,s){const r=this.baseChips,n={win:0,lose:0,deuce:0},o=(new Date).getTime(),i=0;return new l(t,e,r,n,o,i,a,s)},confirmPlayers(t,e=!1){let a=null;a=this.selectPlayers.map(t=>{let a=t.split("-")[1];const s=this.selectPlayersMap.find(t=>t.name==a);let r=s.pid,n=s.avatar;if(e){let e=t.split("-")[0];return{name:e,avatar:n,pid:r}}return{name:a,avatar:n,pid:r}}),a.forEach((e,a)=>{const s=t.findIndex(t=>t.name==e.name);-1===s&&t.push(this.createPlayer(a,e.name,e.avatar,e.pid))})},resetSeat(){const t=this.selectPlayers.map(t=>{const e=t.split("-")[1];return e});if(0===t.length)return void this.$message.warning("请先选择玩家");this.playersSort=[],this.isPlaying=!0,this.confirmPlayers(this.players);const e=this.shuffle(t.map((t,e)=>e+1));t.forEach((t,a)=>{const s=Object(c["a"])(this.players).find(e=>e.name==t);s.seatNum=e[a],s.chips=this.baseChips,this.playersSort.push(s)}),this.playersSort.sort((t,e)=>t.seatNum-e.seatNum)},settleAccount(){const t=this.playersSort.findIndex(t=>""===t.chips);if(-1!==t)return void this.$message.warning("请填写好所有玩家的剩余筹码");const e=this.playersSort.map(t=>parseFloat(t.chips)).reduce((t,e)=>parseFloat(((100*t+100*e)/100).toFixed(2))),a=this.baseChips*this.playersSort.length;if(e===a)this.$confirm("结算前请填写好玩家的剩余筹码, 是否继续结算?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.outputResult(),this.updateRanking(this.players),this.updateScoreboard()}).catch(()=>{});else{const t=((100*a-100*e)/100).toFixed(2);this.$message.error(`输入的剩余筹码总额为${e}，${t>0?"少":"多"}于总筹码${Math.abs(t)}, 请先确认剩余筹码后再进行结算`)}},outputResult(){this.drawer=!0;const t=[],e=[];this.playersSort.forEach(a=>{a["actualChips"]=parseFloat(((100*a.chips-100*this.baseChips)/100).toFixed(2)),a.actualChips>0?(a["result"]="win",t.push(Object(c["a"])(a))):a.actualChips<0?(a["result"]="lose",e.push(Object(c["a"])(a))):a["result"]="deuce"}),this.allot(t,e)},allot(t,e){if(t.sort((t,e)=>e.actualChips-t.actualChips),this.humaneModel?e.sort((t,e)=>t.actualChips-e.actualChips):(e.sort((t,e)=>e.actualChips-t.actualChips),0===e[0].actualChips&&e.splice(0,1)),0!==t[0].actualChips){const a=Math.abs(t[0].actualChips)-Math.abs(e[0].actualChips)<=0?Math.abs(t[0].actualChips):Math.abs(e[0].actualChips);t[0].actualChips=parseFloat(((100*t[0].actualChips-100*a)/100).toFixed(2)),e[0].actualChips=parseFloat(((100*e[0].actualChips+100*a)/100).toFixed(2));const s=`${e[0].name} 向 ${t[0].name} 转账 ${a}元`;this.resultInfo.push(s),this.allot(t,e)}},handleClose(t){this.$confirm("确认关闭？").then(()=>{t(),this.cancelInfo()}).catch(()=>{})},shuffle(t){var e,a,s;for(s=t.length;s;s--)e=Math.floor(Math.random()*s),a=t[s-1],t[s-1]=t[e],t[e]=a;return t},limitInput(t){const e=this.baseChips*this.playersSort.length;t.chips>e&&(t.chips=e),t.chips<0&&(t.chips=0),t.chips=(""+t.chips).replace(/[^\d^.]+/g,"").replace(/^0+(\d)/,"$1").replace(/^\./,"0.").match(/^\d*(\.?\d{0,2})/g)[0]||""},updateRanking(t,e=!1){let a=null;a=Object(c["a"])(this.playersSort).map(t=>(e&&(t.name=t.pid),t)),t.forEach(t=>{const e=a.find(e=>t.name===e.name);if(e){const a=e.actualChips;t.score=parseFloat(((100*a+100*t.score)/100).toFixed(2)),t.raceResult[e.result]++,"deuce"!==e.result&&(e.result===t.lastState?t.stateTimes++:t.stateTimes=1,t.lastState=e.result),t.avatar=e.avatar}}),t.sort((t,e)=>e.score-t.score)},updateScoreboard(){if(this.allPlayers)this.confirmPlayers(this.allPlayers,!0),this.updateRanking(this.allPlayers,!0),localStorage.setItem("allPlayers",JSON.stringify(this.allPlayers));else{const t=Object(c["a"])(this.players).map(t=>(t.name=t.pid,t));this.allPlayers=Object(c["a"])(t),localStorage.setItem("allPlayers",JSON.stringify(this.allPlayers))}},formatterResult(t){return`${t.raceResult.win} / ${t.raceResult.lose}`},formatterWinRate(t){const e=this.computedRate(t);return e+"%"},computedRate(t){const e=t.raceResult.win+t.raceResult.lose+t.raceResult.deuce,a=e&&parseFloat((t.raceResult.win/e*100).toFixed(1));return a},addRateClass(t,e){const a=e.map(t=>this.computedRate(t)),s=Math.max(...a),r=Math.min(...a);return this.computedRate(t)===s?"highest":this.computedRate(t)===r?"lowest":""},formatterState(t){return`${t.stateTimes}连${"lose"===t.lastState?"败":"胜"}`},addStateClass(t,e){const a=e.filter(t=>"lose"===t.lastState).map(t=>t.stateTimes),s=e.filter(t=>"win"===t.lastState).map(t=>t.stateTimes),r=Math.max(...a),n=Math.max(...s);return"win"===t.lastState&&t.stateTimes===n?"highest":"lose"===t.lastState&&t.stateTimes===r?"lowest":""},handleUploadSuccess(t){this.mainAccounts.forEach(e=>{e.label===this.accountForm.mainAccount&&(e.avatar=t)}),this.currentAccountAvatar=t;const e=this.accounts.findIndex(t=>t.name===this.accountForm.mainAccount);-1!==e&&(this.accounts[e].avatar=this.currentAccountAvatar,localStorage.setItem("accounts",JSON.stringify(this.accounts))),this.cropperModel=!1},uploadPicture(t){this.cropperName=t,this.cropperModel=!0},openAddAccount(){this.accountInput="",this.innerVisible=!0},addMainAccount(){this.accountInput?this.isNameRepeat(this.accountInput)?this.$message.error("该名称已存在，请更换名称"):(this.mainAccounts.push({label:this.accountInput,avatar:""}),this.accountForm.mainAccount=this.accountInput,this.innerVisible=!1):this.$message.warning("请输入账号名称")},isNameRepeat(t){const e=[];return this.accounts.forEach(t=>{e.push(t.name),t.subAccounts&&t.subAccounts.length>0&&t.subAccounts.forEach(t=>{e.push(t.name)})}),-1!==e.indexOf(t)},addAccount(){this.isNameRepeat(this.accountForm.subAccount)?this.$message.error("该小号名称已存在，请重新填写"):this.$refs.accountForm.validate(t=>{if(!t)return!1;{const t=this.accounts.findIndex(t=>t.name===this.accountForm.mainAccount),e=`${this.accountForm.mainAccount}-${this.accountForm.subAccount}`;-1===t?this.accounts.push({name:this.accountForm.mainAccount,avatar:this.currentAccountAvatar,subAccounts:[{name:this.accountForm.subAccount,value:`${this.accountForm.mainAccount}-${this.accountForm.subAccount}`}]}):this.accounts[t].subAccounts.push({name:this.accountForm.subAccount,value:e}),localStorage.setItem("accounts",JSON.stringify(this.accounts));const a=this.selectPlayers.findIndex(t=>{const e=t.split("-")[0];return e===this.accountForm.mainAccount});-1!==a?this.selectPlayers.splice(a,1,e):this.selectPlayers.push(e),this.outerVisible=!1}})},handleAddAccountClosed(){this.$refs.accountForm.resetFields()},disabledFun(t){const e=t.split("-")[0],a=t.split("-")[1];return this.selectPlayers.some(t=>{const s=t.split("-")[0],r=t.split("-")[1];return e==s&&a!==r})},gameAgain(){this.resultInfo=[],this.resetSeat(),this.drawer=!1},cancelInfo(){this.resultInfo=[],this.playersSort=[],this.isPlaying=!1,this.drawer=!1}}},y=v,x=(a("6669"),Object(f["a"])(y,o,i,!1,null,"1bfbf5e8",null)),C=x.exports,w={name:"App",components:{GameDetail:C},data(){return{}},methods:{}},S=w,A=(a("2fb8"),Object(f["a"])(S,r,n,!1,null,null,null)),_=A.exports,$=(a("f5df1"),a("5c96")),I=a.n($);a("0fae");s["default"].config.productionTip=!1,s["default"].use(I.a),new s["default"]({render:t=>t(_)}).$mount("#app")},6669:function(t,e,a){"use strict";a("9143")},"8ba7":function(t,e,a){t.exports=a.p+"img/diyiming2.b83ae6d2.svg"},9143:function(t,e,a){},a3b9:function(t,e,a){t.exports=a.p+"img/disanming.b1b1c11f.svg"},b8b4:function(t,e,a){"use strict";a("0b46")},ba15:function(t,e,a){t.exports=a.p+"img/diyiming.c2c550bd.svg"},d4f6:function(t,e,a){t.exports=a.p+"img/dierming.17a01277.svg"},e4c1:function(t,e,a){t.exports=a.p+"img/disanming1.edef0a97.svg"},f6fe:function(t,e,a){}});
//# sourceMappingURL=app.5983d711.js.map